\section{Introduction}
Inferring populations histories is a critical issue in modern sciences. Applied to the human species, it might help us understand where we come from, from a geographical and also an evolutionary point of view.
A first way to learn about populations histories is to look for archeological evidences. Carbon dating technics, introduced in the 1950s by Willard Franck Libby \cite{libby1949}, made it possible to date quite accurately some of these relatively recent evidences of human activity \cite{valladas2001}. Other comparable technics are better adapted to date older events \cite{walter1994}.

In recent years, massive genome sequencing experiments have generated large amounts of data that can be used to confirm or complement archeological theories. Indeed, demographic events as migrations, populations splits or selective pressure have repercussions on genetic diversity among populations. Reversely, quantifying and studying this diversity may help reconstruct the population history. In this context, demographic models can be compared to genetic data using some specific statistics as the allele frequency spectrum (AFS). To this aim, we need to be able to model and simulate these statistics as well as the effects of demographic events and populations histories. Then, we infer the best model and values for the demographic parameters, \textit{i.e.} the most likely knowing the observed data.

There are different ways to model the evolution of the AFS. On the one hand, one can use a backward approach, based on coalescence theory \cite{excoffier2011}. If these methods may be appropriate for neutral simulations, they are initially not designed to take into account selective pressures. On the other hand, forward in time tools have been developed. Most of them are based on the diffusion approximation initiated by Fisher and Wright in the 1930' \cite{fisher1930, wright1931} and then extended more recently \cite{crow1970, kimura1964}. In this approach, the evolution of the AFS is described as a continuous process through a partial differential equation. This formalism makes it possible to take into account a wider variety of demographic and evolutionary processes such as selection and dominance. Several simulating tools based on this diffusion approximation have been implemented and distributed to the population genetics community \cite{gutenkunst2009, lukic2012, lukic2011}, among which $\dadi$ is probably one of the most commonly used. In the past few years, these numerical tools have been used in many works and led to significant results from both historical and biological points of view \cite{gutenkunst2009, gravel2011, schmutz2014}. However, these technics generally involve different levels of numerical approximations such as time and frequency space discretization or numerical computation of integrals.Their use is limited to relatively simple data sets, for instance, $\dadi$ cannot handle more than 3 populations at the time. Moreover, the demographic inference needs numerous simulations of the model and the computation time is a critical challenge if we want to calibrate complex models.

In this document/paper, we describe a new efficient tool to simulate genetic diversity based on the diffusion approximation. We use this method to infer populations histories from genetic data.